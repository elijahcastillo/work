{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useLayoutEffect } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { useAppContext } from \"../context/appContext\";\n\nconst ProtectedRoute = _ref => {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  let navigate = useNavigate();\n  const {\n    isAuthenticated,\n    verifyToken\n  } = useAppContext();\n  useEffect(() => {\n    const checkAuth = async () => {\n      const persist = async () => {\n        const n_token = localStorage.getItem(\"token\");\n\n        if (!n_token) {\n          console.log(\"NO TOKEN\");\n          return;\n        }\n\n        const per = await verifyToken(n_token);\n        return per;\n      };\n\n      const peer = await persist();\n      console.log(peer, \"PERSIST\");\n\n      if (peer == false) {\n        return navigate(\"/login\");\n      }\n\n      if (peer == true) {\n        return;\n      }\n\n      if (!isAuthenticated) {\n        return navigate(\"/login\");\n      }\n    };\n\n    checkAuth();\n  }, [isAuthenticated]);\n  return children;\n};\n\n_s(ProtectedRoute, \"ZkHHqhMXHZsXIWdJjy9bi+slYEU=\", false, function () {\n  return [useNavigate, useAppContext];\n});\n\n_c = ProtectedRoute;\nexport default ProtectedRoute;\n\nvar _c;\n\n$RefreshReg$(_c, \"ProtectedRoute\");","map":{"version":3,"sources":["C:/Users/escbe/Desktop/Code/React/Pern Auth Login/client/src/components/ProtectedRoute.js"],"names":["React","useState","useEffect","useLayoutEffect","useNavigate","useAppContext","ProtectedRoute","children","navigate","isAuthenticated","verifyToken","checkAuth","persist","n_token","localStorage","getItem","console","log","per","peer"],"mappings":";;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,EAAqCC,eAArC,QAA4D,OAA5D;AACA,SAASC,WAAT,QAA4B,kBAA5B;AACA,SAASC,aAAT,QAA8B,uBAA9B;;AAEA,MAAMC,cAAc,GAAG,QAAkB;AAAA;;AAAA,MAAjB;AAAEC,IAAAA;AAAF,GAAiB;AACvC,MAAIC,QAAQ,GAAGJ,WAAW,EAA1B;AACA,QAAM;AAAEK,IAAAA,eAAF;AAAmBC,IAAAA;AAAnB,MAAmCL,aAAa,EAAtD;AAEAH,EAAAA,SAAS,CAAC,MAAM;AACd,UAAMS,SAAS,GAAG,YAAY;AAC5B,YAAMC,OAAO,GAAG,YAAY;AAC1B,cAAMC,OAAO,GAAGC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAhB;;AAEA,YAAI,CAACF,OAAL,EAAc;AACZG,UAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ;AACA;AACD;;AAED,cAAMC,GAAG,GAAG,MAAMR,WAAW,CAACG,OAAD,CAA7B;AACA,eAAOK,GAAP;AACD,OAVD;;AAWA,YAAMC,IAAI,GAAG,MAAMP,OAAO,EAA1B;AAEAI,MAAAA,OAAO,CAACC,GAAR,CAAYE,IAAZ,EAAkB,SAAlB;;AAEA,UAAIA,IAAI,IAAI,KAAZ,EAAmB;AACjB,eAAOX,QAAQ,CAAC,QAAD,CAAf;AACD;;AACD,UAAIW,IAAI,IAAI,IAAZ,EAAkB;AAChB;AACD;;AAED,UAAI,CAACV,eAAL,EAAsB;AACpB,eAAOD,QAAQ,CAAC,QAAD,CAAf;AACD;AACF,KA1BD;;AA4BAG,IAAAA,SAAS;AACV,GA9BQ,EA8BN,CAACF,eAAD,CA9BM,CAAT;AAgCA,SAAOF,QAAP;AACD,CArCD;;GAAMD,c;UACWF,W,EAC0BC,a;;;KAFrCC,c;AAuCN,eAAeA,cAAf","sourcesContent":["import React, { useState, useEffect, useLayoutEffect } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { useAppContext } from \"../context/appContext\";\r\n\r\nconst ProtectedRoute = ({ children }) => {\r\n  let navigate = useNavigate();\r\n  const { isAuthenticated, verifyToken } = useAppContext();\r\n\r\n  useEffect(() => {\r\n    const checkAuth = async () => {\r\n      const persist = async () => {\r\n        const n_token = localStorage.getItem(\"token\");\r\n\r\n        if (!n_token) {\r\n          console.log(\"NO TOKEN\");\r\n          return;\r\n        }\r\n\r\n        const per = await verifyToken(n_token);\r\n        return per;\r\n      };\r\n      const peer = await persist();\r\n\r\n      console.log(peer, \"PERSIST\");\r\n\r\n      if (peer == false) {\r\n        return navigate(\"/login\");\r\n      }\r\n      if (peer == true) {\r\n        return;\r\n      }\r\n\r\n      if (!isAuthenticated) {\r\n        return navigate(\"/login\");\r\n      }\r\n    };\r\n\r\n    checkAuth();\r\n  }, [isAuthenticated]);\r\n\r\n  return children;\r\n};\r\n\r\nexport default ProtectedRoute;\r\n"]},"metadata":{},"sourceType":"module"}